<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FrancoPro - Plateforme d'Apprentissage de la Grammaire Fran√ßaise</title>
    <meta name="description" content="Plateforme interactive pour l'enseignement de la grammaire fran√ßaise. Projet de recherche en Sciences du Langage - Universit√© de Mostaganem.">
    <meta name="keywords" content="grammaire fran√ßaise, FLE, didactique, enseignement des langues">
    <meta name="author" content="Universit√© de Mostaganem">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    <style>
        :root {
            --primary: #1e40af;
            --primary-dark: #1e3a8a;
            --bg: #ffffff;
            --surface: #f8fafc;
            --text: #0f172a;
            --text-secondary: #475569;
            --border: #e2e8f0;
            --success: #10b981;
            --shadow: rgba(0, 0, 0, 0.08);
        }
        [data-theme="dark"] {
            --primary: #3b82f6;
            --bg: #0f172a;
            --surface: #1e293b;
            --text: #f1f5f9;
            --text-secondary: #cbd5e1;
            --border: #334155;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); line-height: 1.7; }
        .header { background: var(--surface); border-bottom: 2px solid var(--border); padding: 1.5rem 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px var(--shadow); }
        .nav { max-width: 1200px; margin: 0 auto; padding: 0 2rem; display: flex; justify-content: space-between; align-items: center; }
        .logo-title { font-size: 1.8rem; font-weight: 700; color: var(--primary); }
        .logo-subtitle { font-size: 0.85rem; color: var(--text-secondary); }
        .theme-toggle { background: var(--surface); border: 2px solid var(--border); padding: 0.6rem 1.2rem; border-radius: 8px; cursor: pointer; }
        .btn-primary { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 0.8rem 1.8rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; text-decoration: none; }
        .hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; padding: 4rem 2rem; text-align: center; }
        .hero h1 { font-size: clamp(2rem, 5vw, 3rem); margin-bottom: 1rem; }
        .university-badge { background: rgba(255, 255, 255, 0.2); padding: 1rem 2rem; border-radius: 10px; display: inline-block; margin-top: 1rem; }
        .research-info { max-width: 1200px; margin: 3rem auto; padding: 0 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .info-card { background: var(--surface); padding: 2rem; border-radius: 12px; border: 2px solid var(--border); text-align: center; }
        .info-icon { font-size: 3rem; margin-bottom: 1rem; }
        .section { margin-bottom: 4rem; max-width: 1200px; margin-left: auto; margin-right: auto; padding: 0 2rem; }
        .section-title { font-size: clamp(1.8rem, 4vw, 2.5rem); color: var(--primary); margin-bottom: 0.5rem; text-align: center; }
        .section-subtitle { color: var(--text-secondary); font-size: 1.1rem; text-align: center; margin-bottom: 2rem; }
        .chat-container { background: var(--surface); border-radius: 12px; padding: 2rem; margin-top: 2rem; }
        .chat-messages { max-height: 500px; overflow-y: auto; margin-bottom: 1.5rem; padding: 1rem; background: var(--bg); border-radius: 10px; }
        .message { margin-bottom: 1.5rem; padding: 1.5rem; border-radius: 10px; }
        .message.user { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; margin-left: 15%; }
        .message.assistant { background: var(--surface); border: 2px solid var(--border); margin-right: 15%; }
        .message-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .action-btn { background: var(--bg); border: 1px solid var(--border); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.85rem; }
        .action-btn:hover { background: var(--primary); color: white; }
        .chat-input { flex: 1; padding: 1rem 1.5rem; border: 2px solid var(--border); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1rem; resize: vertical; min-height: 50px; font-family: inherit; }
        .chat-input:focus { outline: none; border-color: var(--primary); }
        .chat-input-container { display: flex; gap: 1rem; }
        .loading { display: none; text-align: center; padding: 1rem; }
        .loading.active { display: block; }
        .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        footer { background: var(--surface); border-top: 2px solid var(--border); padding: 3rem 2rem; margin-top: 4rem; }
        .footer-content { max-width: 1200px; margin: 0 auto; text-align: center; }
        .toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px); background: var(--success); color: white; padding: 1rem 2rem; border-radius: 8px; z-index: 1001; transition: transform 0.3s; }
        .toast.active { transform: translateX(-50%) translateY(0); }
        @media (max-width: 768px) { .message.user, .message.assistant { margin: 0 0 1rem 0; } }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="logo">
                <div class="logo-title">FrancoPro</div>
                <div class="logo-subtitle">Projet de Recherche en Sciences du Langage</div>
            </div>
            <div style="display: flex; gap: 1rem; align-items: center;">
                <button class="theme-toggle" id="themeToggle">üåô</button>
                <a href="#platform" class="btn-primary">Tester la Plateforme</a>
            </div>
        </nav>
    </header>

    <section class="hero">
        <div style="max-width: 900px; margin: 0 auto;">
            <h1>Plateforme Interactive d'Apprentissage de la Grammaire Fran√ßaise</h1>
            <p style="font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.95;">Application des technologies avanc√©es dans l'enseignement de la grammaire fran√ßaise aux apprenants arabophones</p>
            <div class="university-badge">
                <strong>üéì Universit√© de Mostaganem</strong><br>
                <span style="font-size: 0.9rem;">Facult√© des Langues √âtrang√®res - Master en Sciences du Langage</span>
            </div>
        </div>
    </section>

    <section class="research-info">
        <div class="info-card">
            <div class="info-icon">üéØ</div>
            <h3 style="color: var(--primary);">Domaine</h3>
            <p>Didactique des Langues & Technologies √âducatives</p>
        </div>
        <div class="info-card">
            <div class="info-icon">üî¨</div>
            <h3 style="color: var(--primary);">M√©thodologie</h3>
            <p>Approche Exp√©rimentale</p>
        </div>
        <div class="info-card">
            <div class="info-icon">üë•</div>
            <h3 style="color: var(--primary);">Public Cible</h3>
            <p>Apprenants Arabophones (A1-C2)</p>
        </div>
        <div class="info-card">
            <div class="info-icon">üí°</div>
            <h3 style="color: var(--primary);">Innovation</h3>
            <p>Apprentissage Personnalis√©</p>
        </div>
    </section>

    <main>
        <section class="section" id="platform">
            <h2 class="section-title">Plateforme Interactive</h2>
            <p class="section-subtitle">Testez l'assistant p√©dagogique</p>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message assistant">
                        <strong>üéì Assistant P√©dagogique</strong>
                        <p>Bonjour! Je suis votre assistant p√©dagogique pour l'apprentissage de la grammaire fran√ßaise.</p>
                        <p style="margin-top: 1rem;"><strong>Vous pouvez:</strong></p>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Demander des le√ßons sur n'importe quel sujet grammatical</li>
                            <li>Obtenir des exercices adapt√©s √† votre niveau (A1-C2)</li>
                            <li>Poser des questions sp√©cifiques</li>
                            <li>Recevoir des explications d√©taill√©es</li>
                        </ul>
                    </div>
                </div>
                <div class="loading" id="loading">
                    <span class="spinner"></span> Pr√©paration de la r√©ponse...
                </div>
                <div class="chat-input-container">
                    <textarea class="chat-input" id="chatInput" placeholder="Exemple: Explique-moi le subjonctif avec des exercices..." rows="3"></textarea>
                    <button class="btn-primary" id="sendBtn">Envoyer</button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p style="font-size: 1.1rem; margin-bottom: 1rem;"><strong>FrancoPro</strong> - Plateforme d'apprentissage de la grammaire fran√ßaise</p>
            <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">Universit√© de Mostaganem - Facult√© des Langues √âtrang√®res</p>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">Ann√©e universitaire: 2024-2025</p>
            <div style="padding-top: 2rem; border-top: 2px solid var(--border); color: var(--text-secondary);">
                <p>&copy; 2025 FrancoPro | Projet de Recherche Acad√©mique</p>
                <p style="margin-top: 0.5rem; font-size: 0.95rem;">D√©velopp√© par <strong>BETTAHAR Abdelkrim</strong> - Master Sciences du Langage</p>
            </div>
        </div>
    </footer>

    <div class="toast" id="toast"></div>

    <script>
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        themeToggle.onclick = () => {
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                themeToggle.textContent = 'üåô';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '‚òÄÔ∏è';
            }
        };

        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');
        const loading = document.getElementById('loading');

        async function sendMessage() {
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;

            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.innerHTML = `<strong>Vous</strong><p>${userMessage}</p>`;
            chatMessages.appendChild(userMsg);
            chatInput.value = '';

            loading.classList.add('active');
            chatMessages.scrollTop = chatMessages.scrollHeight;

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: userMessage })
                });

                const data = await response.json();
                loading.classList.remove('active');

                const assistantMsg = document.createElement('div');
                assistantMsg.className = 'message assistant';
                const formatted = data.response.replace(/\n\n/g, '</p><p>').replace(/\n/g, '<br>');
                assistantMsg.innerHTML = `
                    <strong>üéì Assistant P√©dagogique</strong>
                    <div><p>${formatted}</p></div>
                    <div class="message-actions">
                        <button class="action-btn" onclick="copyText(this)">üìã Copier</button>
                        <button class="action-btn" onclick="downloadPDF(this)">üìÑ PDF</button>
                    </div>
                `;
                chatMessages.appendChild(assistantMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            } catch (error) {
                loading.classList.remove('active');
            }
        }

        function copyText(btn) {
            const content = btn.closest('.message').querySelector('div').innerText;
            navigator.clipboard.writeText(content).then(() => {
                showToast('‚úÖ Copi√©');
                btn.innerHTML = '‚úÖ Copi√©';
                setTimeout(() => btn.innerHTML = 'üìã Copier', 2000);
            });
        }

        async function downloadPDF(btn) {
            const content = btn.closest('.message').querySelector('div').innerText;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text('FrancoPro - Le√ßon', 20, 20);
            doc.setFontSize(10);
            doc.text('BETTAHAR Abdelkrim - Universit√© de Mostaganem', 20, 28);
            doc.setFontSize(12);
            const lines = doc.splitTextToSize(content, 170);
            doc.text(lines, 20, 40);
            doc.save(`FrancoPro-${Date.now()}.pdf`);
            showToast('‚úÖ PDF export√©');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), 3000);
        }

        sendBtn.onclick = sendMessage;
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
    </script>
</body>
</html>
